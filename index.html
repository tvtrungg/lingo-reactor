<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO TITLE & DESCRIPTION -->
    <title>Reflex - Luy·ªán Ph·∫£n X·∫° Ti·∫øng Anh & Ti·∫øng Ph√°p Mi·ªÖn Ph√≠</title>
    <meta name="description"
        content="Reflex gi√∫p b·∫°n luy·ªán ph·∫£n x·∫° n√≥i ti·∫øng Anh v√† ti·∫øng Ph√°p t·ª± nhi√™n qua tr√≤ ch∆°i flashcard. T·∫°o b·ªô s∆∞u t·∫≠p t·ª´ v·ª±ng, nghe ph√°t √¢m, h·ªçc theo ch·ªß ƒë·ªÅ AI g·ª£i √Ω. Ho√†n to√†n mi·ªÖn ph√≠!">

    <!-- KEYWORDS (Google √≠t d√πng, nh∆∞ng v·∫´n n√™n c√≥) -->
    <meta name="keywords"
        content="luy·ªán ti·∫øng Anh, luy·ªán ti·∫øng Ph√°p, ph·∫£n x·∫° ti·∫øng Anh, flashcard ti·∫øng Anh, h·ªçc ti·∫øng Ph√°p giao ti·∫øp, t·ª´ v·ª±ng ti·∫øng Anh, t·ª´ v·ª±ng ti·∫øng Ph√°p, app h·ªçc ngo·∫°i ng·ªØ, h·ªçc ti·∫øng Anh mi·ªÖn ph√≠, h·ªçc ti·∫øng Ph√°p mi·ªÖn ph√≠, tvtrung, tvtrrung, lingo reactor, reflex language, reflex app, reflex ti·∫øng Anh, reflex ti·∫øng Ph√°p, h·ªçc ng√¥n ng·ªØ, h·ªçc ngo·∫°i ng·ªØ, h·ªçc t·ª´ v·ª±ng, tr√≤ ch∆°i h·ªçc ti·∫øng Anh, tr√≤ ch∆°i h·ªçc ti·∫øng Ph√°p, h·ªçc ng√¥n ng·ªØ qua tr√≤ ch∆°i, h·ªçc ng√¥n ng·ªØ v·ªõi AI, h·ªçc ti·∫øng Anh v·ªõi AI, h·ªçc ti·∫øng Ph√°p v·ªõi AI, luy·ªán n√≥i ti·∫øng Anh, luy·ªán n√≥i ti·∫øng Ph√°p, h·ªçc ph√°t √¢m ti·∫øng Anh, h·ªçc ph√°t √¢m ti·∫øng Ph√°p, h·ªçc ng√¥n ng·ªØ hi·ªáu qu·∫£, h·ªçc ng√¥n ng·ªØ nhanh ch√≥ng, h·ªçc ng√¥n ng·ªØ t·ª± nhi√™n, h·ªçc ng√¥n ng·ªØ vui v·∫ª, h·ªçc ng√¥n ng·ªØ t∆∞∆°ng t√°c">

    <!-- ROBOTS -->
    <meta name="robots" content="index, follow">

    <!-- CANONICAL URL -->
    <link rel="canonical" href="https://lingo-reactor.vercel.app/index.html">

    <!-- GOOGLE SITE VERIFICATION -->
    <meta name="google-site-verification" content="pC6M7jj2zF1WIk5kXR6nj-sYkHiNmHnIyD_Tn-ZXos4" />

    <!-- FAVICON -->
     
    <link rel="icon" type="image/x-icon" href="/assets/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/assets/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- OPEN GRAPH / FACEBOOK -->
    <meta property="og:title" content="Reflex - Luy·ªán Ph·∫£n X·∫° Ti·∫øng Anh & Ti·∫øng Ph√°p Mi·ªÖn Ph√≠">
    <meta property="og:description"
        content="H·ªçc n√≥i ti·∫øng Anh/Ph√°p t·ª± nhi√™n nh∆∞ ng∆∞·ªùi b·∫£n x·ª©. T·∫°o b·ªô t·ª´ v·ª±ng, nghe ph√°t √¢m, ch∆°i game ph·∫£n x·∫°. Mi·ªÖn ph√≠ 100%!">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lingo-reactor.vercel.app/index.html">
    <meta property="og:image" content="https://lingo-reactor.vercel.app/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="vi_VN">
    <meta property="og:site_name" content="Reflex Language">

    <!-- TWITTER CARD -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Reflex - Luy·ªán Ph·∫£n X·∫° Ti·∫øng Anh & Ti·∫øng Ph√°p Mi·ªÖn Ph√≠">
    <meta name="twitter:description"
        content="H·ªçc n√≥i ti·∫øng Anh/Ph√°p t·ª± nhi√™n nh∆∞ ng∆∞·ªùi b·∫£n x·ª©. T·∫°o b·ªô t·ª´ v·ª±ng, nghe ph√°t √¢m, ch∆°i game ph·∫£n x·∫°. Mi·ªÖn ph√≠ 100%!">
    <meta name="twitter:image" content="https://lingo-reactor.vercel.app/og-image.jpg">

    <!-- JSON-LD SCHEMA.ORG - Web Application -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Reflex - Luy·ªán Ph·∫£n X·∫° Ti·∫øng Anh & Ti·∫øng Ph√°p",
      "description": "·ª®ng d·ª•ng web gi√∫p luy·ªán ph·∫£n x·∫° n√≥i ti·∫øng Anh v√† ti·∫øng Ph√°p t·ª± nhi√™n qua tr√≤ ch∆°i flashcard. T·∫°o b·ªô s∆∞u t·∫≠p t·ª´ v·ª±ng, nghe ph√°t √¢m, h·ªçc theo ch·ªß ƒë·ªÅ AI g·ª£i √Ω.",
      "url": "https://lingo-reactor.vercel.app/index.html",
      "applicationCategory": "Education",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "creator": {
        "@type": "Person",
        "name": "tvtrung"
      },
      "inLanguage": "vi-VN",
      "keywords": "luy·ªán ti·∫øng Anh, luy·ªán ti·∫øng Ph√°p, ph·∫£n x·∫° ti·∫øng Anh, flashcard, h·ªçc ngo·∫°i ng·ªØ"
    }
    </script>

    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <h1>Ph·∫£n x·∫° ng√¥n ng·ªØ</h1>
        <i class="logo">(tvtrung)</i>

        <div class="tab-buttons">
            <button class="tab-btn active" onclick="showTab('setup')">Thi·∫øt l·∫≠p</button>
            <button class="tab-btn" onclick="showTab('collection')">B·ªô s∆∞u t·∫≠p</button>
            <button class="tab-btn" onclick="showTab('game')">Ch∆°i game</button>
            <button class="tab-btn" onclick="showTab('stats')">Th·ªëng k√™</button>
            <button class="tab-btn" onclick="showTab('guide')">H∆∞·ªõng d·∫´n</button>
        </div>

        <!-- Tab Thi·∫øt l·∫≠p -->
        <div id="setup" class="tab-content active">
            <div class="create-collection">
                <div class="form-group">
                    <label for="collectionSelect">Ch·ªçn B·ªô s∆∞u t·∫≠p:</label>
                    <select id="collectionSelect">
                        <option value="">-- Ch·ªçn ho·∫∑c t·∫°o m·ªõi --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newCollectionName">T√™n B·ªô s∆∞u t·∫≠p m·ªõi (n·∫øu c√≥):</label>
                    <input type="text" id="newCollectionName" placeholder="Nh·∫≠p t√™n B·ªô s∆∞u t·∫≠p m·ªõi">
                </div>
            </div>
            <div class="form-group">
                <label for="wordInput">Nh·∫≠p t·ª´ v·ª±ng (m·ªói d√≤ng: Ti·∫øng Vi·ªát : Ti·∫øng Anh/Ph√°p):</label>
                <textarea id="wordInput" placeholder="V√≠ d·ª•:
Xin ch√†o : Hello ho·∫∑c Bonjour
T·∫°m bi·ªát : Goodbye ho·∫∑c Au revoir
C·∫£m ∆°n : Thank you ho·∫∑c Merci
Xin l·ªói : Sorry ho·∫∑c Excusez-moi
T√¥i y√™u b·∫°n : I love you ho·∫∑c Je t'aime"></textarea>
            </div>

            <div class="form-group-wrapper">
                <div class="form-group">
                    <label>Ho·∫∑c t·∫£i file TXT</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="txtFileInput" accept=".txt">
                        <span>üìÅ Ch·ªçn file TXT ho·∫∑c k√©o th·∫£ v√†o ƒë√¢y</span>
                    </div>
                    <p style="font-size: 0.85em; color: #666; margin-top: 5px;">
                        ƒê·ªãnh d·∫°ng: <code>Ti·∫øng Vi·ªát : Ti·∫øng Anh/Ph√°p</code> (m·ªói d√≤ng 1 c·∫∑p)
                    </p>
                </div>
                <div class="form-group">
                    <label>Ho·∫∑c t·∫£i file JSON:</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="fileInput" accept=".json">
                        <span>üìÅ Ch·ªçn file JSON ho·∫∑c k√©o th·∫£ v√†o ƒë√¢y</span>
                    </div>
                </div>
            </div>

            <button class="btn" onclick="addWords()">Th√™m t·ª´ v·ª±ng</button>
        </div>

        <!-- Tab B·ªô s∆∞u t·∫≠p -->
        <div id="collection" class="tab-content">
            <div class="form-group">
                <h3 style="margin-bottom: 20px; color: #4a5568;">Danh s√°ch B·ªô s∆∞u t·∫≠p</h3>

                <!-- TH√äM B·ªò L·ªåC -->
                <div class="filter-buttons"
                    style="margin-bottom: 15px; display: flex; gap: 10px; justify-content: space-between;">
                    <div>
                        <button class="btn btn-success" onclick="saveToFile()">üíæ L∆∞u danh s√°ch</button>
                        <button class="btn btn-danger" onclick="clearCollections()">üóëÔ∏è X√≥a t·∫•t c·∫£</button>
                    </div>
                    <div>
                        <button class="btn filter-btn active" data-lang="all" onclick="filterCollections('all')">
                            T·∫•t c·∫£
                        </button>
                        <button class="btn filter-btn" data-lang="en-US" onclick="filterCollections('en-US')">
                            Ti·∫øng Anh
                        </button>
                        <button class="btn filter-btn" data-lang="fr-FR" onclick="filterCollections('fr-FR')">
                            Ti·∫øng Ph√°p
                        </button>
                    </div>
                </div>


            </div>
            <div id="collectionList" class="collection-list"></div>
        </div>

        <!-- Tab Ch∆°i game -->
        <div id="game" class="tab-content">
            <div class="settings-grid">
                <div class="form-group">
                    <label for="displayTime">Th·ªùi gian hi·ªÉn th·ªã (s):</label>
                    <input type="number" id="displayTime" min="0.5" max="10" step="0.1" value="2">
                </div>
                <div class="form-group">
                    <label for="answerDisplayTime">Th·ªùi gian hi·ªÉn th·ªã ƒë√°p √°n (s):</label>
                    <input type="number" id="answerDisplayTime" min="1" max="10" step="0.1" value="3">
                </div>
                <div class="form-group">
                    <label for="gameMode">Ch·∫ø ƒë·ªô ch∆°i:</label>
                    <select id="gameMode">
                        <option value="vietnamese-to-target">Ti·∫øng Vi·ªát ‚Üí Ti·∫øng Anh/Ph√°p</option>
                        <option value="target-to-vietnamese">Ti·∫øng Anh/Ph√°p ‚Üí Ti·∫øng Vi·ªát</option>
                        <option value="mixed">Tr·ªôn l·∫´n</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="repeatCount">S·ªë l·∫ßn l·∫∑p m·ªói t·ª´:</label>
                    <input type="number" id="repeatCount" min="1" max="10" value="1">
                </div>
            </div>

            <div class="form-group">
                <label for="gameCollectionSelect">Ch·ªçn B·ªô s∆∞u t·∫≠p ƒë·ªÉ ch∆°i:</label>
                <select id="gameCollectionSelect">
                    <option value="">-- T·∫•t c·∫£ t·ª´ v·ª±ng --</option>
                </select>
            </div>
            <div class="game-area">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>

                <div id="gameDisplay">
                    <div class="word-display" id="wordDisplay">Nh·∫•n "B·∫Øt ƒë·∫ßu" ƒë·ªÉ ch∆°i</div>
                </div>

                <div class="game-controls">
                    <button class="btn btn-success" id="startBtn" onclick="startGame()">‚ñ∂Ô∏è B·∫Øt ƒë·∫ßu</button>
                    <button class="btn btn-danger" id="stopBtn" onclick="stopGame()" disabled>‚èπÔ∏è D·ª´ng</button>
                </div>

                <div id="answerDisplay" class="answer-display" style="display: none;"></div>
            </div>
        </div>

        <!-- Tab Th·ªëng k√™ -->
        <div id="stats" class="tab-content">
            <h3 style="margin-bottom: 20px; color: #4a5568; text-align: left;">üìä Th·ªëng k√™ h·ªçc t·∫≠p</h3>
            <div class="settings-grid">
                <div class="stats-card">
                    <div class="stats-number"><span class="stats-icon">üìö</span><span id="totalWords">0</span></div>
                    <div class="stats-label">T·ªïng t·ª´ v·ª±ng</div>
                </div>
                <div class="stats-card">
                    <div class="stats-number"><span class="stats-icon">üóÇÔ∏è</span><span id="totalCollections">0</span>
                    </div>
                    <div class="stats-label">T·ªïng B·ªô s∆∞u t·∫≠p</div>
                </div>
                <div class="stats-card">
                    <div class="stats-number"><span class="stats-icon">üéÆ</span><span id="totalSessions">0</span></div>
                    <div class="stats-label">L·∫ßn ch∆°i</div>
                </div>
                <div class="stats-card">
                    <div class="stats-number"><span class="stats-icon">üîç</span><span id="totalWordsShown">0</span>
                    </div>
                    <div class="stats-label">T·ª´ ƒë√£ hi·ªÉn th·ªã</div>
                </div>
                <div class="stats-card">
                    <div class="stats-number"><span class="stats-icon">‚è±Ô∏è</span><span id="averageTime">0s</span></div>
                    <div class="stats-label">Th·ªùi gian TB</div>
                </div>
            </div>

            <button class="btn btn-danger" onclick="resetStats()">üîÑ ƒê·∫∑t l·∫°i th·ªëng k√™</button>
        </div>

        <!-- Tab H∆∞·ªõng d·∫´n -->
        <div id="guide" class="tab-content">
            <h3 class="guide-title">üìñ H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng Reflex</h3>
            <div class="guide-content">
                <div class="guide-section">
                    <h4>1. Gi·ªõi thi·ªáu</h4>
                    <p>Reflex l√† ·ª©ng d·ª•ng web gi√∫p b·∫°n h·ªçc t·ª´ v·ª±ng v√† luy·ªán ph·∫£n x·∫° giao ti·∫øp ti·∫øng Anh ho·∫∑c ti·∫øng Ph√°p
                        th√¥ng qua tr√≤ ch∆°i. V·ªõi giao di·ªán th√¢n thi·ªán v√† t√≠nh nƒÉng qu·∫£n l√Ω t·ª´ v·ª±ng theo B·ªô s∆∞u t·∫≠p, b·∫°n
                        c√≥ th·ªÉ d·ªÖ d√†ng t·ªï ch·ª©c v√† h·ªçc t·ª´ v·ª±ng hi·ªáu qu·∫£.</p>
                </div>
                <div class="guide-section">
                    <h4>2. Gi·ªõi thi·ªáu v·ªÅ c√°c tabs</h4>
                    <div class="guide-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h5>Tab Thi·∫øt l·∫≠p</h5>
                            <ul>
                                <li>Nh·∫≠p t·ª´ v·ª±ng theo ƒë·ªãnh d·∫°ng: <code>Ti·∫øng Vi·ªát : Ti·∫øng Anh/Ti·∫øng Ph√°p</code> (m·ªói
                                    d√≤ng m·ªôt t·ª´ ho·∫∑c c√¢u).</li>
                                <li>Ch·ªçn ho·∫∑c t·∫°o B·ªô s∆∞u t·∫≠p m·ªõi ƒë·ªÉ t·ªï ch·ª©c t·ª´ v·ª±ng theo ch·ªß ƒë·ªÅ (v√≠ d·ª•: Giao ti·∫øp, Du
                                    l·ªãch).</li>
                                <li>T·∫£i file JSON ƒë·ªÉ nh·∫≠p nhanh danh s√°ch t·ª´ v·ª±ng.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="guide-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h5>Tab B·ªô s∆∞u t·∫≠p</h5>
                            <ul>
                                <li>Xem danh s√°ch c√°c B·ªô s∆∞u t·∫≠p ƒë√£ t·∫°o.</li>
                                <li>Nh·∫•p v√†o B·ªô s∆∞u t·∫≠p ƒë·ªÉ xem t·ª´ v·ª±ng trong Modal.</li>
                                <li>Ch·ªânh s·ª≠a ho·∫∑c x√≥a t·ª´ v·ª±ng b·∫±ng n√∫t "S·ª≠a" ho·∫∑c "X√≥a".</li>
                                <li>Ch·ªçn nhi·ªÅu t·ª´ b·∫±ng checkbox ƒë·ªÉ x√≥a h√†ng lo·∫°t.</li>
                                <li>L∆∞u danh s√°ch B·ªô s∆∞u t·∫≠p ra file JSON.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="guide-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h5>Tab Ch∆°i game</h5>
                            <ul>
                                <li>Ch·ªçn B·ªô s∆∞u t·∫≠p ho·∫∑c s·ª≠ d·ª•ng t·∫•t c·∫£ t·ª´ v·ª±ng ƒë·ªÉ ch∆°i.</li>
                                <li>ƒêi·ªÅu ch·ªânh ch·∫ø ƒë·ªô ch∆°i, th·ªùi gian hi·ªÉn th·ªã, v√† s·ªë l·∫ßn l·∫∑p.</li>
                                <li>Nh·∫•n "B·∫Øt ƒë·∫ßu" ƒë·ªÉ luy·ªán ph·∫£n x·∫° v·ªõi t·ª´ v·ª±ng/c√¢u ng·∫´u nhi√™n.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="guide-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h5>Tab Th·ªëng k√™</h5>
                            <ul>
                                <li>Xem t·ªïng s·ªë t·ª´ v·ª±ng, B·ªô s∆∞u t·∫≠p, l·∫ßn ch∆°i, v√† th·ªùi gian trung b√¨nh.</li>
                                <li>ƒê·∫∑t l·∫°i th·ªëng k√™ n·∫øu c·∫ßn.</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="guide-section">
                    <h4>3. S·ª≠ d·ª•ng AI ƒë·ªÉ t·∫°o m·∫´u c√¢u giao ti·∫øp</h4>
                    <p>S·ª≠ d·ª•ng c√°c m√¥ h√¨nh AI nh∆∞ ChatGPT, Grok,...ƒë·ªÉ t·∫°o c√°c m·∫´u c√¢u giao ti·∫øp ti·∫øng
                        Anh/ti·∫øng Ph√°p v·ªõi ch·ªß ƒë·ªÅ y√™u th√≠ch c·ªßa b·∫°n.</p>
                    <div class="ai-prompt-container">
                        <div class="prompt-header">
                            <h5>T·∫°o Prompt cho AI</h5>
                            <div class="language-toggle">
                                <button class="lang-btn active" onclick="setLanguage('english')">Ti·∫øng Anh</button>
                                <button class="lang-btn" onclick="setLanguage('french')">Ti·∫øng Ph√°p</button>
                            </div>
                        </div>

                        <!-- Input ch·ªß ƒë·ªÅ -->
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label for="themeInput">Ch·ªß ƒë·ªÅ h·ªçc h√¥m nay:</label>
                            <input type="text" id="themeInput"
                                placeholder="V√≠ d·ª•: ƒê·∫∑t m√≥n ƒÉn, ƒêi ch·ª£, G·∫∑p b·∫°n, Du l·ªãch..."
                                style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid #e2e8f0;">
                        </div>

                        <!-- N√∫t t·∫°o prompt -->
                        <button class="btn" onclick="generatePrompt()" style="margin-bottom: 15px;">
                            T·∫°o Prompt
                        </button>

                        <!-- Prompt k·∫øt qu·∫£ -->
                        <div id="generatedPrompt"
                            style="display: none; background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #dee2e6; margin-top: 10px;">
                            <p id="promptText"
                                style="white-space: pre-wrap; font-family: Consolas, monospace; margin: 0; line-height: 1.6;">
                            </p>
                            <button class="btn copy-btn" onclick="copyGeneratedPrompt()" style="margin-top: 10px;">
                                Sao ch√©p Prompt
                            </button>
                        </div>
                    </div>
                </div>
                <div class="guide-section">
                    <h4>4. M·∫πo h·ªçc hi·ªáu qu·∫£</h4>
                    <ul>
                        <li>T·∫°o B·ªô s∆∞u t·∫≠p theo ch·ªß ƒë·ªÅ ri√™ng cho t·ª´ng ng√¥n ng·ªØ (v√≠ d·ª•: "Ti·∫øng Anh - Giao ti·∫øp", "Ti·∫øng
                            Ph√°p - Du l·ªãch").</li>
                        <li>Luy·ªán t·∫≠p h√†ng ng√†y v·ªõi ch·∫ø ƒë·ªô "Tr·ªôn l·∫´n" ƒë·ªÉ tƒÉng ph·∫£n x·∫°.</li>
                        <li>S·ª≠ d·ª•ng AI ƒë·ªÉ l√†m m·ªõi t·ª´ v·ª±ng v√† m·∫´u c√¢u th∆∞·ªùng xuy√™n.</li>
                        <li>Theo d√µi ti·∫øn ƒë·ªô qua tab "Th·ªëng k√™" ƒë·ªÉ duy tr√¨ ƒë·ªông l·ª±c.</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="collectionModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="modal-close" onclick="closeModal()">&times;</span>
                <h3 id="modalTitle" style="margin-bottom: 20px; color: #4a5568;"></h3>
                <div class="form-group">
                    <button class="btn btn-danger" onclick="deleteSelectedWords()" style="display: none;"
                        id="deleteSelectedBtn">üóëÔ∏è X√≥a c√°c t·ª´ ƒë√£ ch·ªçn</button>
                </div>
                <div id="modalWordList" class="word-list"></div>
            </div>
        </div>
    </div>

    <script>
        let collections = [];
        let words = [];
        let currentGameWords = [];
        let currentWordIndex = 0;
        let currentFilter = 'all';
        let isGameRunning = false;
        let gameInterval;
        let gamePhase = 'question'; // 'question' or 'answer'
        let gameStats = {
            totalSessions: 0,
            totalWordsShown: 0,
            totalTime: 0
        };

        let currentAIPromptLang = 'english';

        // Kh·ªüi t·∫°o ·ª©ng d·ª•ng
        function init() {
            loadCollections();
            loadStats();

            // Kh√¥i ph·ª•c filter
            const savedFilter = localStorage.getItem('collectionFilter') || 'all';
            currentFilter = savedFilter;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-lang') === savedFilter) {
                    btn.classList.add('active');
                }
            });

            updateCollectionList();
            updateCollectionSelects();
            updateStats();
            setupFileInput();
            setupTxtFileInput();
        }

        // Ch·ªçn ng√¥n ng·ªØ
        function setLanguage(lang) {
            currentAIPromptLang = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.lang-btn[onclick="setLanguage('${lang}')"]`).classList.add('active');
        }

        // T·∫°o prompt
        function generatePrompt() {
            const theme = document.getElementById('themeInput').value.trim();
            if (!theme) {
                showNotification('Vui l√≤ng nh·∫≠p ch·ªß ƒë·ªÅ h·ªçc!', 'error');
                return;
            }

            const isEnglish = currentAIPromptLang === 'english';
            const language = isEnglish ? 'English' : 'French';

            const promptTemplate = `You are a native ${language} speaker and daily conversation coach with 20+ years helping learners speak naturally ‚Äî without thinking in Vietnamese.
Daily Task:
Generate 10 short, ultra-common ${language} phrases for real-life situations under the theme: ${theme}.
These must be phrases natives say every day ‚Äî the kind you hear in caf√©s, shops, offices, or on the street.
Strict Rules:
1. Grammar: Simple, natural, spoken style (no textbook stiffness)
2. No rare words, no idioms, no complex tenses
3. Format exactly: Vietnamese meaning: ${language} phrase
4. DO NOT number, explain, transliterate, or add anything else
Today‚Äôs language: ${language}
Today‚Äôs theme: ${theme}`;

            document.getElementById('promptText').textContent = promptTemplate;
            document.getElementById('generatedPrompt').style.display = 'block';
            showNotification('ƒê√£ t·∫°o prompt! Nh·∫•n "Sao ch√©p" ƒë·ªÉ d√πng.', 'success');
        }

        // Sao ch√©p prompt ƒë√£ t·∫°o
        function copyGeneratedPrompt() {
            const text = document.getElementById('promptText').textContent;
            navigator.clipboard.writeText(text).then(() => {
                showNotification('ƒê√£ sao ch√©p prompt!', 'success');
            }).catch(() => {
                showNotification('L·ªói khi sao ch√©p!', 'error');
            });
        }

        // Chuy·ªÉn ƒë·ªïi tab
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            document.querySelector(`.tab-btn[onclick="showTab('${tabName}')"]`).classList.add('active');

            if (tabName === 'collection') {
                updateCollectionList(); // Refresh v·ªõi filter hi·ªán t·∫°i
            }
        }

        function filterCollections(lang) {
            currentFilter = lang;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active');
                }
            });
            updateCollectionList();
            localStorage.setItem('collectionFilter', lang); // L∆∞u tr·∫°ng th√°i
        }

        // Th√™m t·ª´ v·ª±ng
        function addWords() {
            const input = document.getElementById('wordInput').value.trim();
            const collectionSelect = document.getElementById('collectionSelect').value;
            const newCollectionName = document.getElementById('newCollectionName').value.trim();

            if (!input) {
                showNotification('Vui l√≤ng nh·∫≠p t·ª´ v·ª±ng!', 'error');
                return;
            }

            let collectionId = collectionSelect;
            let detectedLanguage = 'fr-FR'; // M·∫∑c ƒë·ªãnh

            if (newCollectionName && !collectionSelect) {
                // T·ª± ƒë·ªông detect t·ª´ input
                detectedLanguage = detectLanguage(input);
                collectionId = Date.now().toString();
                collections.push({
                    id: collectionId,
                    name: newCollectionName,
                    words: [],
                    language: detectedLanguage
                });
            } else if (!collectionSelect) {
                showNotification('Vui l√≤ng ch·ªçn ho·∫∑c t·∫°o m·ªõi m·ªôt B·ªô s∆∞u t·∫≠p!', 'error');
                return;
            }

            const lines = input.split('\n');
            let addedCount = 0;
            lines.forEach(line => {
                const parts = line.split(':');
                if (parts.length === 2) {
                    const vietnamese = parts[0].trim();
                    const target = parts[1].trim();
                    if (vietnamese && target) {
                        const word = { vietnamese, french: target };
                        const collection = collections.find(c => c.id === collectionId);
                        if (collection) {
                            if (!collection.words.some(w => w.vietnamese === vietnamese && w.french === target)) {
                                collection.words.push(word);
                                addedCount++;
                            }
                        }
                        if (!words.some(w => w.vietnamese === vietnamese && w.french === target)) {
                            words.push(word);
                        }
                    }
                }
            });

            if (addedCount > 0) {
                document.getElementById('wordInput').value = '';
                document.getElementById('newCollectionName').value = '';
                saveCollections();
                saveWords();
                updateCollectionList();
                updateCollectionSelects();
                updateStats();
                showNotification(`ƒê√£ th√™m ${addedCount} t·ª´ v·ª±ng v√†o B·ªô s∆∞u t·∫≠p ${newCollectionName}!`, 'success');
                showTab('collection');
            } else {
                showNotification('Kh√¥ng c√≥ t·ª´ v·ª±ng h·ª£p l·ªá!', 'error');
            }
        }

        // X√≥a t·∫•t c·∫£ B·ªô s∆∞u t·∫≠p
        function clearCollections() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ B·ªô s∆∞u t·∫≠p?')) {
                collections = [];
                words = [];
                saveCollections();
                saveWords();
                updateCollectionList();
                updateCollectionSelects();
                updateStats();
                document.getElementById('fileInput').value = ''; // Reset file input
                showNotification('ƒê√£ x√≥a t·∫•t c·∫£ B·ªô s∆∞u t·∫≠p!', 'info');
            }
        }

        // X√≥a m·ªôt B·ªô s∆∞u t·∫≠p
        function deleteCollection(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a B·ªô s∆∞u t·∫≠p n√†y?')) {
                collections = collections.filter(c => c.id !== id);
                words = words.filter(w => !collections.some(c => c.words.some(cw => cw.vietnamese === w.vietnamese && cw.french === w.french)));
                saveCollections();
                saveWords();
                updateCollectionList();
                updateCollectionSelects();
                updateStats();
                showNotification('ƒê√£ x√≥a B·ªô s∆∞u t·∫≠p!', 'info');
            }
        }

        // X√≥a m·ªôt t·ª´ v·ª±ng
        function deleteWord(collectionId, index) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·ª´ n√†y?')) {
                const collection = collections.find(c => c.id === collectionId);
                if (collection) {
                    const [removedWord] = collection.words.splice(index, 1);
                    words = words.filter(w => !(w.vietnamese === removedWord.vietnamese && w.french === removedWord.french));
                    saveCollections();
                    saveWords();
                    updateStats();
                    showCollectionWords(collectionId); // Refresh modal
                    showNotification('ƒê√£ x√≥a t·ª´ v·ª±ng!', 'info');
                }
            }
        }

        // C·∫≠p nh·∫≠t danh s√°ch B·ªô s∆∞u t·∫≠p
        function updateCollectionList() {
            const collectionListDiv = document.getElementById('collectionList');

            let filtered = collections;
            if (currentFilter !== 'all') {
                filtered = collections.filter(c => c.language === currentFilter);
            }

            if (filtered.length === 0) {
                const noDataMsg = currentFilter === 'all'
                    ? 'Ch∆∞a c√≥ B·ªô s∆∞u t·∫≠p n√†o. H√£y th√™m t·ª´ v·ª±ng ƒë·ªÉ t·∫°o!'
                    : `Kh√¥ng c√≥ B·ªô s∆∞u t·∫≠p n√†o cho <strong>${currentFilter === 'en-US' ? 'Ti·∫øng Anh' : 'Ti·∫øng Ph√°p'}</strong>.`;
                collectionListDiv.innerHTML = `<p style="text-align: center; color: #666;">${noDataMsg}</p>`;
                return;
            }

            collectionListDiv.innerHTML = filtered.map(collection => {
                const langLabel = collection.language === 'en-US' ? 'Ti·∫øng Anh' : 'Ti·∫øng Ph√°p';
                const langIcon = collection.language === 'en-US' ? 'UK Flag' : 'France Flag';
                const langColor = collection.language === 'en-US' ? '#f56565' : '#48bb78';

                return `
            <div class="collection-item" onclick="showCollectionWords('${collection.id}')" style="cursor: pointer; border-left: 4px solid ${langColor};">
                <span>
                    <strong>${collection.name}</strong> (${collection.words.length} t·ª´)
                    <small style="margin-left: 8px; color: ${langColor};">
                        [${langLabel}]
                    </small>
                </span>
                <button class="delete-btn" onclick="event.stopPropagation(); deleteCollection('${collection.id}')">X√≥a</button>
            </div>
        `;
            }).join('');
        }

        // Hi·ªÉn th·ªã t·ª´ v·ª±ng trong B·ªô s∆∞u t·∫≠p qua Modal
        function showCollectionWords(collectionId) {
            const collection = collections.find(c => c.id === collectionId);
            if (!collection) return;

            const modal = document.getElementById('collectionModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalWordList = document.getElementById('modalWordList');

            modalTitle.textContent = collection.name;
            modalWordList.innerHTML = collection.words.length === 0 ?
                '<p style="text-align: center; color: #666;">Ch∆∞a c√≥ t·ª´ v·ª±ng trong B·ªô s∆∞u t·∫≠p n√†y.</p>' :
                collection.words.map((word, index) => `
                    <div class="word-item" id="word-item-${collectionId}-${index}">
                        <input type="checkbox" class="word-checkbox" data-collection-id="${collectionId}" data-index="${index}">
                        <span class="word-text"><strong>${word.vietnamese}</strong> ‚Üí ${word.french}</span>
                        <div>
                            <button class="play-btn" onclick="speakWord('${word.french.replace(/'/g, "\\'")}', '${collection.language || "fr-FR"}')"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon"><path d="M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"/></svg></button>
                            <button class="edit-btn" onclick="editWord('${collectionId}', ${index})"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon"><path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"/><path d="m15 5 4 4"/></svg></button>
                            <button class="delete-btn" onclick="deleteWord('${collectionId}', ${index})"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon"><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M3 6h18"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button>
                        </div>
                    </div>
                `).join('');

            modal.style.display = 'flex';
            document.querySelectorAll('.word-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', updateDeleteSelectedButton);
            });
            updateDeleteSelectedButton();
        }

        // H√†m ph√°t √¢m
        function speakWord(text, lang) {
            if ('speechSynthesis' in window) {
                const utter = new SpeechSynthesisUtterance(text);
                utter.lang = lang;
                speechSynthesis.speak(utter);
            } else {
                showNotification('Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ ph√°t √¢m!', 'error');
            }
        }
        // Ch·ªânh s·ª≠a t·ª´ v·ª±ng
        function editWord(collectionId, index) {
            const collection = collections.find(c => c.id === collectionId);
            if (!collection) return;

            const word = collection.words[index];
            const wordItem = document.getElementById(`word-item-${collectionId}-${index}`);
            wordItem.innerHTML = `
                <div class="edit-form">
                    <input type="text" id="edit-vietnamese-${collectionId}-${index}" value="${word.vietnamese}">
                    <span> ‚Üí </span>
                    <input type="text" id="edit-french-${collectionId}-${index}" value="${word.french}">
                    <div>
                        <button class="play-btn btn-success" onclick="saveWord('${collectionId}', ${index})"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon"><path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"/><path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"/><path d="M7 3v4a1 1 0 0 0 1 1h7"/></svg></button>
                        
                        <button class="delete-btn btn-danger" onclick="showCollectionWords('${collectionId}')"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg></button>
                    </div>
                </div>
            `;
        }

        // L∆∞u t·ª´ v·ª±ng sau khi ch·ªânh s·ª≠a
        function saveWord(collectionId, index) {
            const collection = collections.find(c => c.id === collectionId);
            if (!collection) return;

            const vietnamese = document.getElementById(`edit-vietnamese-${collectionId}-${index}`).value.trim();
            const french = document.getElementById(`edit-french-${collectionId}-${index}`).value.trim();

            if (vietnamese && french) {
                const oldWord = collection.words[index];
                collection.words[index] = { vietnamese, french };

                // C·∫≠p nh·∫≠t danh s√°ch words t·ªïng
                const wordIndex = words.findIndex(w => w.vietnamese === oldWord.vietnamese && w.french === oldWord.french);
                if (wordIndex !== -1) {
                    words[wordIndex] = { vietnamese, french };
                } else {
                    words.push({ vietnamese, french });
                }

                saveCollections();
                saveWords();
                updateStats();
                showCollectionWords(collectionId);
                showNotification('ƒê√£ c·∫≠p nh·∫≠t t·ª´ v·ª±ng!', 'success');
            } else {
                showNotification('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß t·ª´ v·ª±ng!', 'error');
            }
        }
        // X√≥a c√°c t·ª´ ƒë∆∞·ª£c ch·ªçn
        function deleteSelectedWords() {
            const checkboxes = document.querySelectorAll('.word-checkbox:checked');
            if (checkboxes.length === 0) {
                showNotification('Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt t·ª´ ƒë·ªÉ x√≥a!', 'error');
                return;
            }

            if (confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ${checkboxes.length} t·ª´ ƒë√£ ch·ªçn?`)) {
                const collectionUpdates = {};
                checkboxes.forEach(checkbox => {
                    const collectionId = checkbox.getAttribute('data-collection-id');
                    const index = parseInt(checkbox.getAttribute('data-index'));

                    if (!collectionUpdates[collectionId]) {
                        collectionUpdates[collectionId] = [];
                    }
                    collectionUpdates[collectionId].push(index);
                });

                Object.keys(collectionUpdates).forEach(collectionId => {
                    const collection = collections.find(c => c.id === collectionId);
                    if (collection) {
                        const indices = collectionUpdates[collectionId].sort((a, b) => b - a);
                        indices.forEach(index => {
                            const [removedWord] = collection.words.splice(index, 1);
                            words = words.filter(w => !(w.vietnamese === removedWord.vietnamese && w.french === removedWord.french));
                        });
                    }
                });

                saveCollections();
                saveWords();
                updateStats();
                showCollectionWords(Object.keys(collectionUpdates)[0]); // Refresh modal with the first updated collection
                showNotification(`ƒê√£ x√≥a ${checkboxes.length} t·ª´ v·ª±ng!`, 'info');
            }
        }

        // C·∫≠p nh·∫≠t tr·∫°ng th√°i n√∫t x√≥a nhi·ªÅu t·ª´
        function updateDeleteSelectedButton() {
            const deleteBtn = document.getElementById('deleteSelectedBtn');
            const checkboxes = document.querySelectorAll('.word-checkbox:checked');
            deleteBtn.style.display = checkboxes.length > 0 ? 'inline-block' : 'none';
        }

        // ƒê√≥ng Modal
        function closeModal() {
            document.getElementById('collectionModal').style.display = 'none';
            updateCollectionList(); // C·∫≠p nh·∫≠t l·∫°i danh s√°ch B·ªô s∆∞u t·∫≠p khi ƒë√≥ng modal
        }

        // ƒê√≥ng Modal khi nh·∫•p ra ngo√†i
        document.getElementById('collectionModal').addEventListener('click', function (event) {
            if (event.target === this) {
                closeModal();
            }
        });

        // C·∫≠p nh·∫≠t danh s√°ch B·ªô s∆∞u t·∫≠p trong select box
        function updateCollectionSelects() {
            const collectionSelect = document.getElementById('collectionSelect');
            const gameCollectionSelect = document.getElementById('gameCollectionSelect');
            const options = collections.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
            collectionSelect.innerHTML = '<option value="">-- Ch·ªçn ho·∫∑c t·∫°o m·ªõi --</option>' + options;
            gameCollectionSelect.innerHTML = '<option value="">-- T·∫•t c·∫£ t·ª´ v·ª±ng --</option>' + options;
        }

        // B·∫Øt ƒë·∫ßu game
        function startGame() {
            const collectionId = document.getElementById('gameCollectionSelect').value;
            const repeatCount = parseInt(document.getElementById('repeatCount').value) || 1;

            let gameWords = collectionId ?
                collections.find(c => c.id === collectionId)?.words || [] :
                [...words];

            if (gameWords.length === 0) {
                showNotification('Vui l√≤ng th√™m t·ª´ v·ª±ng tr∆∞·ªõc khi ch∆°i!', 'error');
                return;
            }

            isGameRunning = true;
            gamePhase = 'question';
            currentWordIndex = 0;
            currentGameWords = [];

            // T·∫°o danh s√°ch t·ª´ v·ªõi s·ªë l·∫ßn l·∫∑p
            for (let i = 0; i < repeatCount; i++) {
                const shuffled = [...gameWords].sort(() => Math.random() - 0.5);
                currentGameWords.push(...shuffled);
            }

            document.getElementById('startBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;

            gameStats.totalSessions++;
            saveStats();
            updateStats();

            showNextWord();
        }

        // D·ª´ng game
        function stopGame() {
            isGameRunning = false;
            clearInterval(gameInterval);

            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('answerDisplay').style.display = 'none';

            document.getElementById('wordDisplay').textContent = 'Game ƒë√£ d·ª´ng';
            document.getElementById('progressFill').style.width = '0%';

            showNotification('Game ƒë√£ d·ª´ng!', 'info');
        }

        // Hi·ªÉn th·ªã t·ª´ ti·∫øp theo
        function showNextWord() {
            if (!isGameRunning || currentWordIndex >= currentGameWords.length) {
                stopGame();
                showNotification('ƒê√£ ho√†n th√†nh t·∫•t c·∫£ t·ª´ v·ª±ng!', 'success');
                return;
            }

            const currentWord = currentGameWords[currentWordIndex];
            const displayTime = parseFloat(document.getElementById('displayTime').value) * 1000;
            const answerDisplayTime = parseFloat(document.getElementById('answerDisplayTime').value) * 1000;
            const gameMode = document.getElementById('gameMode').value;

            if (gamePhase === 'question') {
                document.getElementById('answerDisplay').style.display = 'none';

                let displayText = '';
                if (gameMode === 'vietnamese-to-target') {
                    displayText = currentWord.vietnamese;
                } else if (gameMode === 'target-to-vietnamese') {
                    displayText = currentWord.french; // Assuming French as target, adjust if English is preferred
                } else { // mixed mode
                    displayText = Math.random() > 0.5 ? currentWord.vietnamese : currentWord.french;
                }

                document.getElementById('wordDisplay').textContent = displayText;

                const progress = ((currentWordIndex + 1) / currentGameWords.length) * 100;
                document.getElementById('progressFill').style.width = progress + '%';

                gameStats.totalWordsShown++;
                gameStats.totalTime += displayTime;
                saveStats();
                updateStats();

                gamePhase = 'answer';
                gameInterval = setTimeout(() => {
                    showCurrentAnswer();
                }, displayTime);
            } else if (gamePhase === 'answer') {
                currentWordIndex++;
                gamePhase = 'question';
                gameInterval = setTimeout(() => {
                    showNextWord();
                }, answerDisplayTime);
            }
        }

        // Hi·ªÉn th·ªã ƒë√°p √°n c·ªßa t·ª´ hi·ªán t·∫°i
        function showCurrentAnswer() {
            if (!isGameRunning || currentWordIndex >= currentGameWords.length) return;

            const currentWord = currentGameWords[currentWordIndex];
            const gameMode = document.getElementById('gameMode').value;
            const currentDisplay = document.getElementById('wordDisplay').textContent;
            let answerHTML = '';

            if (gameMode === 'vietnamese-to-target') {
                answerHTML = `
                    <div class="answer-french">${currentWord.french}</div>
                `;
            } else if (gameMode === 'target-to-vietnamese') {
                answerHTML = `
                    <div class="answer-french">${currentWord.french}</div>
                `;
            } else { // mixed mode
                if (currentDisplay === currentWord.vietnamese) {
                    answerHTML = `
                        <div class="answer-french">${currentWord.french}</div>
                    `;
                } else {
                    answerHTML = `
                        <div class="answer-french">${currentWord.french}</div>
                    `;
                }
            }

            document.getElementById('answerDisplay').innerHTML = answerHTML;
            document.getElementById('answerDisplay').style.display = 'block';

            showNextWord();
        }

        // L∆∞u Collections
        function saveCollections() {
            localStorage.setItem('frenchCollections', JSON.stringify(collections));
        }

        // T·∫£i Collections
        function loadCollections() {
            const savedCollections = localStorage.getItem('frenchCollections');
            if (savedCollections) {
                collections = JSON.parse(savedCollections);
                collections.forEach(c => {
                    if (!c.language) c.language = 'fr-FR'; // Default n·∫øu thi·∫øu
                    c.words.forEach(w => {
                        if (!words.some(wd => wd.vietnamese === w.vietnamese && wd.french === w.french)) {
                            words.push(w);
                        }
                    });
                });
            }
        }

        // L∆∞u t·ª´ v·ª±ng
        function saveWords() {
            localStorage.setItem('frenchWords', JSON.stringify(words));
        }

        // T·∫£i t·ª´ v·ª±ng
        function loadWords() {
            const savedWords = localStorage.getItem('frenchWords');
            if (savedWords) {
                words = JSON.parse(savedWords);
            }
        }

        // L∆∞u th·ªëng k√™
        function saveStats() {
            localStorage.setItem('frenchGameStats', JSON.stringify(gameStats));
        }

        // T·∫£i th·ªëng k√™
        function loadStats() {
            const savedStats = localStorage.getItem('frenchGameStats');
            if (savedStats) {
                gameStats = JSON.parse(savedStats);
            }
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™
        function updateStats() {
            document.getElementById('totalWords').textContent = words.length;
            document.getElementById('totalCollections').textContent = collections.length;
            document.getElementById('totalSessions').textContent = gameStats.totalSessions;
            document.getElementById('totalWordsShown').textContent = gameStats.totalWordsShown;

            const avgTime = gameStats.totalWordsShown > 0 ?
                (gameStats.totalTime / gameStats.totalWordsShown / 1000).toFixed(1) : 0;
            document.getElementById('averageTime').textContent = avgTime + 's';
        }

        // ƒê·∫∑t l·∫°i th·ªëng k√™
        function resetStats() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën ƒë·∫∑t l·∫°i t·∫•t c·∫£ th·ªëng k√™?')) {
                gameStats = {
                    totalSessions: 0,
                    totalWordsShown: 0,
                    totalTime: 0
                };
                saveStats();
                updateStats();
                showNotification('ƒê√£ ƒë·∫∑t l·∫°i th·ªëng k√™!', 'info');
            }
        }

        // L∆∞u danh s√°ch t·ª´ v·ª±ng ra file JSON
        function saveToFile() {
            if (collections.length === 0) {
                showNotification('Kh√¥ng c√≥ B·ªô s∆∞u t·∫≠p n√†o ƒë·ªÉ l∆∞u!', 'error');
                return;
            }

            const dataStr = JSON.stringify(collections, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);

            const exportFileDefaultName = 'french-collections.json';
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();

            showNotification('ƒê√£ l∆∞u file th√†nh c√¥ng!', 'success');
        }

        // Thi·∫øt l·∫≠p file input
        function setupFileInput() {
            const fileInput = document.getElementById('fileInput');
            fileInput.addEventListener('change', handleFileSelect);
        }

        // Thi·∫øt l·∫≠p file input TXT
        function setupTxtFileInput() {
            const txtFileInput = document.getElementById('txtFileInput');
            txtFileInput.addEventListener('change', handleTxtFileSelect);
        }

        // T·ª± ƒë·ªông ph√°t hi·ªán ng√¥n ng·ªØ: Anh hay Ph√°p
        function detectLanguage(text) {
            const sample = text.toLowerCase().replace(/[^a-z√†-√ø\s]/g, ' ').trim();
            if (!sample) return 'fr-FR'; // M·∫∑c ƒë·ªãnh

            const words = sample.split(/\s+/).filter(w => w.length > 2);

            // T·ª´ ƒëi·ªÉn nh·ªè (c√°c t·ª´ ph·ªï bi·∫øn)
            const englishWords = new Set(['the', 'and', 'is', 'are', 'of', 'in', 'to', 'for', 'with', 'on', 'at', 'by', 'an', 'be', 'this', 'that', 'have', 'it', 'not', 'you', 'he', 'she', 'we', 'they', 'but', 'or', 'as', 'what', 'which', 'who', 'when', 'where', 'why', 'how']);
            const frenchWords = new Set(['le', 'la', 'les', 'de', 'des', 'un', 'une', 'et', 'est', 'sont', 'dans', 'pour', 'avec', 'sur', 'par', 'je', 'tu', 'il', 'elle', 'nous', 'vous', 'ils', 'elles', 'mais', 'ou', 'comme', 'que', 'qui', 'quoi', 'quand', 'o√π', 'pourquoi', 'comment', 'ce', 'cette', 'ces']);

            let engCount = 0, frCount = 0;

            words.forEach(word => {
                if (englishWords.has(word)) engCount++;
                if (frenchWords.has(word)) frCount++;
            });

            // ∆Øu ti√™n t·ª´ ƒëi·ªÉn
            if (engCount > frCount && engCount > 0) return 'en-US';
            if (frCount > engCount && frCount > 0) return 'fr-FR';

            // N·∫øu t·ª´ ƒëi·ªÉn kh√¥ng ƒë·ªß, d√πng regex
            const engPattern = /\b(th|ing|ed|tion|ly|ness|the|and|is)\b/i;
            const frPattern = /\b(de|le|la|des|un|une|je|tu|il|au|aux|√†|√ß|√©|√®|√™|√¥)\b/i;

            const engMatches = (sample.match(engPattern) || []).length;
            const frMatches = (sample.match(frPattern) || []).length;

            return engMatches >= frMatches ? 'en-US' : 'fr-FR';
        }

        // X·ª≠ l√Ω file TXT
        function handleTxtFileSelect(event) {
            const file = event.target.files[0];
            if (!file || file.type !== 'text/plain') {
                showNotification('Vui l√≤ng ch·ªçn file .txt h·ª£p l·ªá!', 'error');
                return;
            }

            const collectionSelect = document.getElementById('collectionSelect').value;
            const newCollectionName = document.getElementById('newCollectionName').value.trim();

            if (!collectionSelect && !newCollectionName) {
                showNotification('Vui l√≤ng ch·ªçn ho·∫∑c t·∫°o m·ªõi B·ªô s∆∞u t·∫≠p!', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
                const text = e.target.result;
                let detectedLanguage = detectLanguage(text); // T·ª± ƒë·ªông detect

                let collectionId = collectionSelect;
                if (newCollectionName && !collectionSelect) {
                    collectionId = Date.now().toString();
                    collections.push({
                        id: collectionId,
                        name: newCollectionName,
                        words: [],
                        language: detectedLanguage
                    });
                    showNotification(`T·∫°o m·ªõi: ${newCollectionName} [${detectedLanguage === 'en-US' ? 'Ti·∫øng Anh' : 'Ti·∫øng Ph√°p'}]`, 'success');
                }

                const lines = text.split('\n');
                let addedCount = 0;
                lines.forEach(line => {
                    const trimmed = line.trim();
                    if (!trimmed) return;
                    const parts = trimmed.split(':');
                    if (parts.length !== 2) return;
                    const vietnamese = parts[0].trim();
                    const target = parts[1].trim();
                    if (!vietnamese || !target) return;

                    const word = { vietnamese, french: target };
                    const collection = collections.find(c => c.id === collectionId);
                    if (collection && !collection.words.some(w => w.vietnamese === vietnamese && w.french === target)) {
                        collection.words.push(word);
                        addedCount++;
                    }
                    if (!words.some(w => w.vietnamese === vietnamese && w.french === target)) {
                        words.push(word);
                    }
                });

                if (addedCount > 0) {
                    saveCollections();
                    saveWords();
                    updateCollectionList();
                    updateCollectionSelects();
                    updateStats();
                    showNotification(`ƒê√£ th√™m ${addedCount} t·ª´ v·ª±ng t·ª´ file!`, 'success');
                    showTab('collection');
                } else {
                    showNotification('Kh√¥ng c√≥ t·ª´ v·ª±ng h·ª£p l·ªá!', 'warning');
                }

                document.getElementById('txtFileInput').value = '';
                document.getElementById('newCollectionName').value = '';
            };

            reader.readAsText(file, 'UTF-8');
        }

        // X·ª≠ l√Ω file ƒë∆∞·ª£c ch·ªçn
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file && file.type === 'application/json') {
                const reader = new FileReader();
                reader.onload = function (e) {
                    try {
                        const importedCollections = JSON.parse(e.target.result);
                        if (Array.isArray(importedCollections)) {
                            importedCollections.forEach(importedCollection => {
                                let collection = collections.find(c => c.id === importedCollection.id);
                                if (!collection) {
                                    collection = { id: importedCollection.id, name: importedCollection.name, words: [] };
                                    collections.push(collection);
                                }
                                collection.words = [...importedCollection.words]; // Replace words in existing collection
                                importedCollection.words.forEach(w => {
                                    if (!words.some(wd => wd.vietnamese === w.vietnamese && wd.french === w.french)) {
                                        words.push(w);
                                    }
                                });
                            });
                            saveCollections();
                            saveWords();
                            updateCollectionList();
                            updateCollectionSelects();
                            updateStats();
                            showNotification(`ƒê√£ t·∫£i ${importedCollections.length} B·ªô s∆∞u t·∫≠p!`, 'success');
                            showTab('collection');
                        } else {
                            showNotification('File JSON kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng!', 'error');
                        }
                    } catch (error) {
                        showNotification('L·ªói khi ƒë·ªçc file JSON!', 'error');
                    }
                };
                reader.readAsText(file);
                document.getElementById('fileInput').value = ''; // Reset file input
            } else {
                showNotification('Vui l√≤ng ch·ªçn file JSON!', 'error');
            }
        }

        // Hi·ªÉn th·ªã th√¥ng b√°o
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.classList.add('show');
            }, 100);

            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Hi·ªÉn th·ªã prompt theo ng√¥n ng·ªØ
        function showPrompt(language) {
            const frenchPrompt = document.getElementById('aiPromptFrench');
            const englishPrompt = document.getElementById('aiPromptEnglish');
            const frenchBtn = document.querySelector('.lang-btn[onclick="showPrompt(\'french\')"]');
            const englishBtn = document.querySelector('.lang-btn[onclick="showPrompt(\'english\')"]');

            if (language === 'french') {
                frenchPrompt.style.display = 'block';
                englishPrompt.style.display = 'none';
                frenchBtn.classList.add('active');
                englishBtn.classList.remove('active');
            } else {
                frenchPrompt.style.display = 'none';
                englishPrompt.style.display = 'block';
                frenchBtn.classList.remove('active');
                englishBtn.classList.add('active');
            }
        }

        // Sao ch√©p prompt
        function copyPrompt() {
            const frenchPrompt = document.getElementById('aiPromptFrench');
            const englishPrompt = document.getElementById('aiPromptEnglish');
            const activePrompt = frenchPrompt.style.display === 'block' ? frenchPrompt : englishPrompt;

            navigator.clipboard.writeText(activePrompt.textContent.trim())
                .then(() => showNotification('ƒê√£ sao ch√©p prompt!', 'success'))
                .catch(() => showNotification('L·ªói khi sao ch√©p prompt!', 'error'));
        }

        // Kh·ªüi t·∫°o ·ª©ng d·ª•ng
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>